/*See bookmarklet.js for well-formatted, commented source code*/

var hpg={};
(function(){
var sourceCode=("(function(replacementPrefs){var prefs={passwordLength:10,email:\"\",username:\"\",algorithm:\"hpg\",onlyFill2Fields:true,autoCompOff:true,master:\"%s\",salt:\"\",customAlgorithm:\"md5\",separator:\":\",encoding:\"hex\",useHMAC:false};var hashLib={hexcase:0,b64pad:\"\",digest:function(string,algorithm,outputFormat){var rawHash=this.rawDigest(this.hashes[algorithm.toLowerCase()],string);switch(outputFormat){case \"b64\":return this.rstr2b64(rawHash);break;case \"hex\":return this.rstr2hex(rawHash);break;case \"raw\":return rawHash;break;default:return this.rstr2any(rawHash,outputFormat);}},HMAC:function(key,data,algorithm,outputFormat){algorithm=algorithm.toLowerCase();var hashLengths={sha1:160,sha256:256,sha224:224,md2:128,ripemd:160,md5:128,sha512:512,sha384:384};var blocksizes={sha512:1024,sha384:1024};var rawHash=this.rawHMAC(this.hashes[algorithm],hashLengths[algorithm],key,data,blocksizes[algorithm]);switch(outputFormat.toLowerCase()){case \"b64\":return this.rstr2b64(rawHash);break;case \"hex\":return this.rstr2hex(rawHash);break;case \"raw\":return rawHash;break;default:return this.rstr2any(rawHash,outputFormat);}},rawDigest:function(hashFunction,s){s=this.str2rstr_utf8(s);return this.binb2rstr(hashFunction(this.rstr2binb(s),s.length*8));},rawHMAC:function(hashFunction,hashLength,k,d,blockSize){blockSize=blockSize?blockSize:512;var key=this.str2rstr_utf8(k);var data=this.str2rstr_utf8(d);var bkey=this.rstr2binb(key);if(bkey.length>blockSize>>5){bkey=hashFunction(bkey,key.length*8);}var ipad=Array(blockSize>>5),opad=Array(blockSize>>5);for(var i=0;i<blockSize>>5;i++){ipad[i]=bkey[i]^909522486;opad[i]=bkey[i]^1549556828;}var hash=hashFunction(ipad.concat(this.rstr2binb(data)),blockSize+data.length*8);return this.binb2rstr(hashFunction(opad.concat(hash),blockSize+hashLength));},rstr2hex:function(input){if(!(\"hexcase\" in this)){this.hexcase=0;}var hex_tab=this.hexcase?\"0123456789ABCDEF\":\"0123456789abcdef\";var output=\"\";var x;for(var i=0;i<input.length;i++){x=input.charCodeAt(i);output+=hex_tab.charAt(x>>>4&15)+hex_tab.charAt(x&15);}return output;},rstr2hex2:function(str){function byteToHex(charCode){return(\"0\"+charCode.toString(16)).slice(-2);}hex=\"\";for(var i=0;i<str.length;i++){hex+=byteToHex(str.charCodeAt(i));}if(this.hexcase==1){hex=hex.toUpperCase();}return hex;},rstr2b64:function(input){try{return btoa(input).replace(/=/g,this.b64pad?this.b64pad:\"\");}catch(e){return this.rstr2b64_safe(input);}},rstr2b64_safe:function(input){if(!(\"b64pad\" in this)){this.b64pad=\"\";}var tab=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";var output=\"\";var len=input.length;for(var i=0;i<len;i+=3){var triplet=input.charCodeAt(i)<<16|(i+1<len?input.charCodeAt(i+1)<<8:0)|(i+2<len?input.charCodeAt(i+2):0);for(var j=0;j<4;j++){if(i*8+j*6>input.length*8){output+=this.b64pad;}else{output+=tab.charAt(triplet>>>6*(3-j)&63);}}}return output;},rstr2any:function(input,charset){var divisor=charset.length;var remainders=Array();var i,q,x,quotients;var dividends=Array(Math.ceil(input.length/2));for(i=0;i<dividends.length;i++){dividends[i]=input.charCodeAt(i*2)<<8|input.charCodeAt(i*2+1);}while(dividends.length>0){quotients=Array();x=0;for(i=0;i<dividends.length;i++){x=(x<<16)+dividends[i];q=Math.floor(x/divisor);x-=q*divisor;if(quotients.length>0||q>0){quotients[quotients.length]=q;}}remainders[remainders.length]=x;dividends=quotients;}var output=\"\";for(i=remainders.length-1;i>=0;i--){output+=charset.charAt(remainders[i]);}var full_length=Math.ceil(input.length*8/(Math.log(charset.length)/Math.log(2)));for(i=output.length;i<full_length;i++){output=charset[0]+output;}return output;},str2rstr_utf8:function(input){var output=\"\";var i=-1;var x,y;while(++i<input.length){x=input.charCodeAt(i);y=i+1<input.length?input.charCodeAt(i+1):0;if(55296<=x&&x<=56319&&56320<=y&&y<=57343){x=65536+((x&1023)<<10)+(y&1023);i++;}if(x<=127){output+=String.fromCharCode(x);}else if(x<=2047){output+=String.fromCharCode(192|x>>>6&31,128|x&63);}else if(x<=65535){output+=String.fromCharCode(224|x>>>12&15,128|x>>>6&63,128|x&63);}else if(x<=2097151){output+=String.fromCharCode(240|x>>>18&7,128|x>>>12&63,128|x>>>6&63,128|x&63);}}return output;},rstr2binb:function(input){var output=Array(input.length>>2);for(var i=0;i<output.length;i++){output[i]=0;}for(var i=0;i<input.length*8;i+=8){output[i>>5]|=(input.charCodeAt(i/8)&255)<<(24-i&31);}return output;},binb2rstr:function(input){var output=\"\";for(var i=0;i<input.length*32;i+=8){output+=String.fromCharCode(input[i>>5]>>>(24-i&31)&255);}return output;},add:function(x,y){x?0:(x=0);y?0:(y=0);return x+y|0;},bit_rol:function(num,cnt){return num<<cnt|num>>>32-cnt;},hashes:{}};hashLib.hashes.sha1=function(x,len){var add=hashLib.add;var bit_rol=hashLib.bit_rol;function ft(t,b,c,d){if(t<20){return b&c|~b&d;}if(t<40){return b^c^d;}if(t<60){return b&c|b&d|c&d;}return b^c^d;}function kt(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514;}x[len>>5]|=128<<(24-len&31);x[(len+64>>9<<4)+15]=len;var w=Array(80);var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;var e=-1009589776;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;var olde=e;for(var j=0;j<80;j++){if(j<16){w[j]=x[i+j];}else{w[j]=bit_rol(w[j-3]^w[j-8]^w[j-14]^w[j-16],1);}var t=add(add(bit_rol(a,5),ft(j,b,c,d)),add(add(e,w[j]),kt(j)));e=d;d=c;c=bit_rol(b,30);b=a;a=t;}a=add(a,olda);b=add(b,oldb);c=add(c,oldc);d=add(d,oldd);e=add(e,olde);}return [a,b,c,d,e];};hashLib.hashes.sha224=function(m,l){var add=hashLib.add;var K=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];function S(X,n){return X>>>n|X<<32-n;}function R(X,n){return X>>>n;}function Ch(x,y,z){return x&y^~x&z;}function Maj(x,y,z){return x&y^x&z^y&z;}function Sigma0256(x){return S(x,2)^S(x,13)^S(x,22);}function Sigma1256(x){return S(x,6)^S(x,11)^S(x,25);}function Gamma0256(x){return S(x,7)^S(x,18)^R(x,3);}function Gamma1256(x){return S(x,17)^S(x,19)^R(x,10);}function Sigma0512(x){return S(x,28)^S(x,34)^S(x,39);}function Sigma1512(x){return S(x,14)^S(x,18)^S(x,41);}function Gamma0512(x){return S(x,1)^S(x,8)^R(x,7);}function Gamma1512(x){return S(x,19)^S(x,61)^R(x,6);}var HASH=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];var W=new Array(64);var a,b,c,d,e,f,g,h;var i,j,T1,T2;m[l>>5]|=128<<(24-l&31);m[(l+64>>9<<4)+15]=l;for(i=0;i<m.length;i+=16){a=HASH[0];b=HASH[1];c=HASH[2];d=HASH[3];e=HASH[4];f=HASH[5];g=HASH[6];h=HASH[7];for(j=0;j<64;j++){if(j<16){W[j]=m[j+i];}else{W[j]=add(add(add(Gamma1256(W[j-2]),W[j-7]),Gamma0256(W[j-15])),W[j-16]);}T1=add(add(add(add(h,Sigma1256(e)),Ch(e,f,g)),K[j]),W[j]);T2=add(Sigma0256(a),Maj(a,b,c));h=g;g=f;f=e;e=add(d,T1);d=c;c=b;b=a;a=add(T1,T2);}HASH[0]=add(a,HASH[0]);HASH[1]=add(b,HASH[1]);HASH[2]=add(c,HASH[2]);HASH[3]=add(d,HASH[3]);HASH[4]=add(e,HASH[4]);HASH[5]=add(f,HASH[5]);HASH[6]=add(g,HASH[6]);HASH[7]=add(h,HASH[7]);}return HASH.splice(0,7);};hashLib.hashes.sha256=function(m,l){var add=hashLib.add;var K=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];function S(X,n){return X>>>n|X<<32-n;}function R(X,n){return X>>>n;}function Ch(x,y,z){return x&y^~x&z;}function Maj(x,y,z){return x&y^x&z^y&z;}function Sigma0256(x){return S(x,2)^S(x,13)^S(x,22);}function Sigma1256(x){return S(x,6)^S(x,11)^S(x,25);}function Gamma0256(x){return S(x,7)^S(x,18)^R(x,3);}function Gamma1256(x){return S(x,17)^S(x,19)^R(x,10);}function Sigma0512(x){return S(x,28)^S(x,34)^S(x,39);}function Sigma1512(x){return S(x,14)^S(x,18)^S(x,41);}function Gamma0512(x){return S(x,1)^S(x,8)^R(x,7);}function Gamma1512(x){return S(x,19)^S(x,61)^R(x,6);}var HASH=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var W=new Array(64);var a,b,c,d,e,f,g,h;var i,j,T1,T2;m[l>>5]|=128<<(24-l&31);m[(l+64>>9<<4)+15]=l;for(i=0;i<m.length;i+=16){a=HASH[0];b=HASH[1];c=HASH[2];d=HASH[3];e=HASH[4];f=HASH[5];g=HASH[6];h=HASH[7];for(j=0;j<64;j++){if(j<16){W[j]=m[j+i];}else{W[j]=add(add(add(Gamma1256(W[j-2]),W[j-7]),Gamma0256(W[j-15])),W[j-16]);}T1=add(add(add(add(h,Sigma1256(e)),Ch(e,f,g)),K[j]),W[j]);T2=add(Sigma0256(a),Maj(a,b,c));h=g;g=f;f=e;e=add(d,T1);d=c;c=b;b=a;a=add(T1,T2);}HASH[0]=add(a,HASH[0]);HASH[1]=add(b,HASH[1]);HASH[2]=add(c,HASH[2]);HASH[3]=add(d,HASH[3]);HASH[4]=add(e,HASH[4]);HASH[5]=add(f,HASH[5]);HASH[6]=add(g,HASH[6]);HASH[7]=add(h,HASH[7]);}return HASH;};hashLib.hashes.md5=function(x,len){var add=hashLib.add;var bit_rol=hashLib.bit_rol;function binl2binb(l){var b=[];for(var i=0,num;num=l[i];i++){b.push(((num&255)<<24)+((num&65280)<<8)+((num&16711680)>>>8)+(num>>>24&255));}return b;}function cmn(q,a,b,x,s,t){return add(bit_rol(add(add(a,q),add(x,t)),s),b);}function ff(a,b,c,d,x,s,t){return cmn(b&c|~b&d,a,b,x,s,t);}function gg(a,b,c,d,x,s,t){return cmn(b&d|c&~d,a,b,x,s,t);}function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t);}function ii(a,b,c,d,x,s,t){return cmn(c^(b|~d),a,b,x,s,t);}x=binl2binb(x);x[len>>5]|=128<<(len&31);x[(len+64>>>9<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=ff(a,b,c,d,x[i+0],7,-680876936);d=ff(d,a,b,c,x[i+1],12,-389564586);c=ff(c,d,a,b,x[i+2],17,606105819);b=ff(b,c,d,a,x[i+3],22,-1044525330);a=ff(a,b,c,d,x[i+4],7,-176418897);d=ff(d,a,b,c,x[i+5],12,1200080426);c=ff(c,d,a,b,x[i+6],17,-1473231341);b=ff(b,c,d,a,x[i+7],22,-45705983);a=ff(a,b,c,d,x[i+8],7,1770035416);d=ff(d,a,b,c,x[i+9],12,-1958414417);c=ff(c,d,a,b,x[i+10],17,-42063);b=ff(b,c,d,a,x[i+11],22,-1990404162);a=ff(a,b,c,d,x[i+12],7,1804603682);d=ff(d,a,b,c,x[i+13],12,-40341101);c=ff(c,d,a,b,x[i+14],17,-1502002290);b=ff(b,c,d,a,x[i+15],22,1236535329);a=gg(a,b,c,d,x[i+1],5,-165796510);d=gg(d,a,b,c,x[i+6],9,-1069501632);c=gg(c,d,a,b,x[i+11],14,643717713);b=gg(b,c,d,a,x[i+0],20,-373897302);a=gg(a,b,c,d,x[i+5],5,-701558691);d=gg(d,a,b,c,x[i+10],9,38016083);c=gg(c,d,a,b,x[i+15],14,-660478335);b=gg(b,c,d,a,x[i+4],20,-405537848);a=gg(a,b,c,d,x[i+9],5,568446438);d=gg(d,a,b,c,x[i+14],9,-1019803690);c=gg(c,d,a,b,x[i+3],14,-187363961);b=gg(b,c,d,a,x[i+8],20,1163531501);a=gg(a,b,c,d,x[i+13],5,-1444681467);d=gg(d,a,b,c,x[i+2],9,-51403784);c=gg(c,d,a,b,x[i+7],14,1735328473);b=gg(b,c,d,a,x[i+12],20,-1926607734);a=hh(a,b,c,d,x[i+5],4,-378558);d=hh(d,a,b,c,x[i+8],11,-2022574463);c=hh(c,d,a,b,x[i+11],16,1839030562);b=hh(b,c,d,a,x[i+14],23,-35309556);a=hh(a,b,c,d,x[i+1],4,-1530992060);d=hh(d,a,b,c,x[i+4],11,1272893353);c=hh(c,d,a,b,x[i+7],16,-155497632);b=hh(b,c,d,a,x[i+10],23,-1094730640);a=hh(a,b,c,d,x[i+13],4,681279174);d=hh(d,a,b,c,x[i+0],11,-358537222);c=hh(c,d,a,b,x[i+3],16,-722521979);b=hh(b,c,d,a,x[i+6],23,76029189);a=hh(a,b,c,d,x[i+9],4,-640364487);d=hh(d,a,b,c,x[i+12],11,-421815835);c=hh(c,d,a,b,x[i+15],16,530742520);b=hh(b,c,d,a,x[i+2],23,-995338651);a=ii(a,b,c,d,x[i+0],6,-198630844);d=ii(d,a,b,c,x[i+7],10,1126891415);c=ii(c,d,a,b,x[i+14],15,-1416354905);b=ii(b,c,d,a,x[i+5],21,-57434055);a=ii(a,b,c,d,x[i+12],6,1700485571);d=ii(d,a,b,c,x[i+3],10,-1894986606);c=ii(c,d,a,b,x[i+10],15,-1051523);b=ii(b,c,d,a,x[i+1],21,-2054922799);a=ii(a,b,c,d,x[i+8],6,1873313359);d=ii(d,a,b,c,x[i+15],10,-30611744);c=ii(c,d,a,b,x[i+6],15,-1560198380);b=ii(b,c,d,a,x[i+13],21,1309151649);a=ii(a,b,c,d,x[i+4],6,-145523070);d=ii(d,a,b,c,x[i+11],10,-1120210379);c=ii(c,d,a,b,x[i+2],15,718787259);b=ii(b,c,d,a,x[i+9],21,-343485551);a=add(a,olda);b=add(b,oldb);c=add(c,oldc);d=add(d,oldd);}return binl2binb([a,b,c,d]);};hashLib.hashes.sha512=function(x,len){function int64copy(dst,src){dst.h=src.h;dst.l=src.l;}function int64rrot(dst,x,shift){dst.l=x.l>>>shift|x.h<<32-shift;dst.h=x.h>>>shift|x.l<<32-shift;}function int64revrrot(dst,x,shift){dst.l=x.h>>>shift|x.l<<32-shift;dst.h=x.l>>>shift|x.h<<32-shift;}function int64shr(dst,x,shift){dst.l=x.l>>>shift|x.h<<32-shift;dst.h=x.h>>>shift;}function int64add(dst,x,y){var w0=(x.l&65535)+(y.l&65535);var w1=(x.l>>>16)+(y.l>>>16)+(w0>>>16);var w2=(x.h&65535)+(y.h&65535)+(w1>>>16);var w3=(x.h>>>16)+(y.h>>>16)+(w2>>>16);dst.l=w0&65535|w1<<16;dst.h=w2&65535|w3<<16;}function int64add4(dst,a,b,c,d){var w0=(a.l&65535)+(b.l&65535)+(c.l&65535)+(d.l&65535);var w1=(a.l>>>16)+(b.l>>>16)+(c.l>>>16)+(d.l>>>16)+(w0>>>16);var w2=(a.h&65535)+(b.h&65535)+(c.h&65535)+(d.h&65535)+(w1>>>16);var w3=(a.h>>>16)+(b.h>>>16)+(c.h>>>16)+(d.h>>>16)+(w2>>>16);dst.l=w0&65535|w1<<16;dst.h=w2&65535|w3<<16;}function int64add5(dst,a,b,c,d,e){var w0=(a.l&65535)+(b.l&65535)+(c.l&65535)+(d.l&65535)+(e.l&65535);var w1=(a.l>>>16)+(b.l>>>16)+(c.l>>>16)+(d.l>>>16)+(e.l>>>16)+(w0>>>16);var w2=(a.h&65535)+(b.h&65535)+(c.h&65535)+(d.h&65535)+(e.h&65535)+(w1>>>16);var w3=(a.h>>>16)+(b.h>>>16)+(c.h>>>16)+(d.h>>>16)+(e.h>>>16)+(w2>>>16);dst.l=w0&65535|w1<<16;dst.h=w2&65535|w3<<16;}var H=[new int64(1779033703,-205731576),new int64(-1150833019,-2067093701),new int64(1013904242,-23791573),new int64(-1521486534,1595750129),new int64(1359893119,-1377402159),new int64(-1694144372,725511199),new int64(528734635,-79577749),new int64(1541459225,327033209)];var T1=new int64(0,0),T2=new int64(0,0),a=new int64(0,0),b=new int64(0,0),c=new int64(0,0),d=new int64(0,0),e=new int64(0,0),f=new int64(0,0),g=new int64(0,0),h=new int64(0,0),s0=new int64(0,0),s1=new int64(0,0),Ch=new int64(0,0),Maj=new int64(0,0),r1=new int64(0,0),r2=new int64(0,0),r3=new int64(0,0);var j,i;var W=new Array(80);for(i=0;i<80;i++){W[i]=new int64(0,0);}x[len>>5]|=128<<24-(len&31);x[(len+128>>10<<5)+31]=len;for(i=0;i<x.length;i+=32){int64copy(a,H[0]);int64copy(b,H[1]);int64copy(c,H[2]);int64copy(d,H[3]);int64copy(e,H[4]);int64copy(f,H[5]);int64copy(g,H[6]);int64copy(h,H[7]);for(j=0;j<16;j++){W[j].h=x[i+2*j];W[j].l=x[i+2*j+1];}for(j=16;j<80;j++){int64rrot(r1,W[j-2],19);int64revrrot(r2,W[j-2],29);int64shr(r3,W[j-2],6);s1.l=r1.l^r2.l^r3.l;s1.h=r1.h^r2.h^r3.h;int64rrot(r1,W[j-15],1);int64rrot(r2,W[j-15],8);int64shr(r3,W[j-15],7);s0.l=r1.l^r2.l^r3.l;s0.h=r1.h^r2.h^r3.h;int64add4(W[j],s1,W[j-7],s0,W[j-16]);}for(j=0;j<80;j++){Ch.l=e.l&f.l^~e.l&g.l;Ch.h=e.h&f.h^~e.h&g.h;int64rrot(r1,e,14);int64rrot(r2,e,18);int64revrrot(r3,e,9);s1.l=r1.l^r2.l^r3.l;s1.h=r1.h^r2.h^r3.h;int64rrot(r1,a,28);int64revrrot(r2,a,2);int64revrrot(r3,a,7);s0.l=r1.l^r2.l^r3.l;s0.h=r1.h^r2.h^r3.h;Maj.l=a.l&b.l^a.l&c.l^b.l&c.l;Maj.h=a.h&b.h^a.h&c.h^b.h&c.h;int64add5(T1,h,s1,Ch,k[j],W[j]);int64add(T2,s0,Maj);int64copy(h,g);int64copy(g,f);int64copy(f,e);int64add(e,d,T1);int64copy(d,c);int64copy(c,b);int64copy(b,a);int64add(a,T1,T2);}int64add(H[0],H[0],a);int64add(H[1],H[1],b);int64add(H[2],H[2],c);int64add(H[3],H[3],d);int64add(H[4],H[4],e);int64add(H[5],H[5],f);int64add(H[6],H[6],g);int64add(H[7],H[7],h);}var hash=new Array(16);for(i=0;i<8;i++){hash[2*i]=H[i].h;hash[2*i+1]=H[i].l;}return hash;};var hashes=function(){function mpwgen(master,domain,length){var s=domain+master;var C=\"0123456789abcdefghijklmnopqrstuvwxyz.\",h=7919,i,j=\"\";for(i=0;i<s.length;i++){h=(h<<5)+h+C.indexOf(s.charAt(i));}while(h!=0){j+=C.charAt(h&15);h=h>>>4;}return j.slice(0,length);}function sgp(master,domain,len){function checkPasswd(Passwd){var lowerStart=Passwd.search(/[a-z]/)===0;var hasDigits=Passwd.search(/[0-9]/)>0;var hasUpper=Passwd.search(/[A-Z]/)>0;return lowerStart&&hasDigits&&hasUpper;}var str=master+(\":\"+domain);undefined==len?(len=10):len;var i=0;while(i<10||!checkPasswd(str.substring(0,len))){str=hashLib.digest(str,\"md5\",\"b64\").replace(/\\//g,\"8\").replace(/\\+/g,\"9\").replace(/\\=/g,\"\")+\"AA\";i++;}return str.substring(0,len);}function hpg(master,domain,len){function checkPasswd(Passwd){var lowerStart=Passwd.search(/[a-z]/)===0;var hasDigits=Passwd.search(/[0-9]/)>0;var hasUpper=Passwd.search(/[A-Z]/)>0;var noSymbols=Passwd.search(/[/+]/)==-1;return lowerStart&&hasDigits&&hasUpper&&noSymbols;}var str;undefined==len?(len=10):len;var i=0;while(i<10||!checkPasswd(str.substring(0,len))){var newMaster=hashLib.HMAC(master,domain,\"sha256\",\"hex\");var newDomain=hashLib.HMAC(domain,master,\"sha256\",\"hex\");var str=hashLib.HMAC(domain+newMaster,master+newDomain,\"sha1\",\"b64\");domain=newDomain;master=newMaster;i++;}return str.substring(0,len);}function pwdHash(password,realm,length){var PasswordPrefix=\"@@\";var len=PasswordPrefix.length;function applyConstraints(hash,size,nonalphanumeric){var startingSize=size-4;var result=hash.substring(0,startingSize);var extras=hash.substring(startingSize).split(\"\");function nextExtra(){return extras.length?extras.shift().charCodeAt(0):0;}function nextExtraChar(){return String.fromCharCode(nextExtra());}function rotate(arr,amount){while(amount--){arr.push(arr.shift());}}function between(min,interval,offset){return min+offset%interval;}function nextBetween(base,interval){return String.fromCharCode(between(base.charCodeAt(0),interval,nextExtra()));}function contains(regex){return result.match(regex);}result+=contains(/[A-Z]/)?nextExtraChar():nextBetween(\"A\",26);result+=contains(/[a-z]/)?nextExtraChar():nextBetween(\"a\",26);result+=contains(/[0-9]/)?nextExtraChar():nextBetween(\"0\",10);result+=contains(/\\W/)&&nonalphanumeric?nextExtraChar():\"+\";while(contains(/\\W/)&&!nonalphanumeric){result=result.replace(/\\W/,nextBetween(\"A\",26));}result=result.split(\"\");rotate(result,nextExtra());return result.join(\"\");}password.substring(0,len)==PasswordPrefix?(password=password.substring(len)):false;var hash=hashLib.HMAC(password,realm,\"md5\",\"b64\");var size=password.length+len;var nonalphanumeric=password.match(/\\W/)!=null;var result=applyConstraints(hash,size,nonalphanumeric);return result;}function customHash(master,domain,length){var algorithm=prefs.customAlgorithm;var domainFirst=false;var separator=prefs.separator;var encoding=prefs.encoding;var prefix=\"\";var suffix=\"\";var hashValue;if(prefs.useHMAC){var key=domainFirst?domain:master;var data=domainFirst?master:domain;hashValue=hashLib.HMAC(key,data,algorithm,encoding);}else{var toHash=domainFirst?domain+separator+master:master+separator+domain;hashValue=hashLib.digest(toHash,algorithm,encoding);}return prefix+hashValue.substring(0,length-(prefix.length+suffix.length))+suffix;}function customFunction(master,domain,length){return eval(prefs.customFunction);}return{mpwgen:mpwgen,sgp:sgp,hpg:hpg,pwdhash:pwdHash,custom:customHash,customfunction:customFunction};}();function fillForms(masterPw){if(masterPw){var win=window;fillDocument(masterPw,win.document);for(var i=0;i<win.frames.length;i++){fillDocument(masterPw,win.frames[i].document);}}}function makePass(master,domain){var length=prefs.passwordLength;var algorithm=prefs.algorithm;return hashes[algorithm.toLowerCase()](master,domain,length);}function getDomain(){if(\"domain\" in prefs){return prefs.domain;}var docHost=location.host;var host=\"\",tmpHost;tmpHost=String(docHost).match(/(.*\\.)?(.+\\..{2,7})/);if(tmpHost&&tmpHost[2]){host=tmpHost[2];}tmpHost=String(docHost).match(/(.*\\.)?(.*\\.((ac|biz|co|com|edu|gov|info|int|mil|name|net|org)\\.[a-z]{2}))/);if(tmpHost&&tmpHost[2]){host=tmpHost[2];}return host;}var getFieldTypes=function(form){function findFieldType(el){try{function oneElXpath(doc,exp){var result=doc.evaluate(exp,doc,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);return result.snapshotItem(0);}var doc=el.ownerDocument;if(el.type in{checkbox:1,hidden:1,radio:1,reset:1}){return null;}if(el.tagName.toLowerCase()!=\"input\"){return null;}if(\"password\"==String(el.type)||\"password\"==String(el.name).toLowerCase()){return \"password\";}if(\"submit\"==el.type||\"image\"==el.type){return \"submit\";}var userScore=0;var emailScore=0;var label=null;if(\"\"!=el.id){label=oneElXpath(doc,\"//label[@for=\\\"\"+el.id+\"\\\"]\");}else{label=el;while(label&&\"LABEL\"!=label.tagName){label=label.parentNode;}}var txt=\"\";if(label){txt=label.textContent;}else{try{var tmpid=\"msgpgen\"+String(Math.random()).substr(2);var tmptxt=doc.createTextNode(tmpid);el.appendChild(tmptxt);txt=doc.body.textContent.replace(/\\s+/g,\" \");var pos=txt.indexOf(tmpid);txt=txt.substring(pos-20,pos);el.removeChild(tmptxt);}catch(e){dumpErr(e);txt=\"\";}}if(txt.match(/\\b(e-?mail)\\b/i)||el.name.match(/^e$|e-?mail/i)){return \"email\";}if(txt.match(/\\b((user|member)?name|log?in|id)\\b/i)||el.name.match(/user|username|login|id/i)){return \"user\";}}catch(e){return null;}return null;}var passFields=[],emailFields=[],userFields=[],submitElement;if(form.elements){for(var j=0,el;el=form.elements[j];j++){var type=findFieldType(el);if(!type){continue;}else if(\"password\"==type){passFields.push(el);}if(0==el.offsetWidth){continue;}if(\"user\"==type){userFields.push(el);}else if(\"email\"==type){emailFields.push(el);}else if(\"submit\"==type){submitElement=el;}}return{passFields:passFields,emailFields:emailFields,userFields:userFields,submitElement:submitElement};}else{return{passFields:null};}};function fillDocument(master,doc){var host=getDomain();var user=prefs.username;var email=prefs.email;if(\"@\"==email.charAt(0)){email=host.match(/[^.]*/)+email;}email=email.replace(\"+@\",\"+\"+host.match(/[^.]*/)+\"@\");var fieldNum;var forms=doc.forms;if(!forms.length){return;}var pass=makePass(master,host);for(var i=0;forms[i];i++){var form=forms[i];var formType=getFieldTypes(form);if(formType.passFields){if(prefs.autoCompOff){form.setAttribute(\"autocomplete\",\"off\");}fillPassFields(formType.passFields,pass);for(var j=0,el;el=formType.emailFields[j];j++){if(email){el.value=email;}}for(var j=0,el;el=formType.userFields[j];j++){if(user){el.value=user;}}if(formType.submitElement){formType.submitElement.focus();}}}}function fillPassFields(passFields,pass){var onlyFill2Fields=prefs.onlyFill2Fields;if(3==passFields.length&&onlyFill2Fields){passFields[1].value=pass;passFields[2].value=pass;}else{for(var j=0;passFields[j];j++){passFields[j].value=pass;}}}function getMaster(){if(\"master\" in prefs&&prefs.master!=String.fromCharCode(37,115)){return prefs.master;}else{return prompt(\"Master?\",\"\");}}if(replacementPrefs){for(var v in replacementPrefs){prefs[v]=replacementPrefs[v];}}if(\"run\" in prefs&&prefs.run){return makePass(getMaster(),getDomain());}else{fillForms(getMaster()+prefs.salt);}})");
hpg=eval(sourceCode);
hpg.sourceCode=sourceCode;
})()

(function(){
	var scriptElement=document.getElementById("hpg-s")
	if(scriptElement){
		hpg.apply(this,scriptElement.params);
	}
})()